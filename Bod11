-- Cấu hình ESP nâng cao
local ESP_CONFIG = {
    Size = UDim2.new(0,120,0,40),            -- Kích thước GUI to hơn
    Offset = Vector3.new(0,7,0),             -- Vị trí cao hơn so với part

    Text = {
        Font = Enum.Font.GothamBold,         -- Font chữ đẹp, đậm
        Color = Color3.fromRGB(0,255,128),   -- Màu chữ sáng hơn
        StrokeColor = Color3.fromRGB(0,0,0), -- Viền chữ đen
        StrokeTransparency = 0,               -- 0 = hiện rõ
    },

    Background = {
        Color = Color3.fromRGB(20,20,20),    -- Nền hơi tối
        Transparency = 0.3,                  -- Trong suốt vừa đủ
    },

    Border = {
        Enabled = true,
        Thickness = 3,                       -- Viền dày hơn
        Color = Color3.fromRGB(0,255,128),   -- Viền đồng màu chữ
    }
}

-- Chính
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local localPlayer = Players.LocalPlayer

_G.runMyESPScript = true 
local plotsFolder = Workspace:WaitForChild("Plots")
local espList = {}

local function clearESP()
    for _, esp in pairs(espList) do
        if esp and esp.Parent then esp:Destroy() end
    end
    table.clear(espList)
end

local function getRemainingTimeText(plot)
    for _, part in ipairs(plot:GetDescendants()) do
        if part:IsA("TextLabel") and part.Name=="RemainingTime" then
            return part.Text:gsub("s","")
        end
    end
    return nil
end

local function findESPPart(plot)
    for _, part in ipairs(plot:GetDescendants()) do
        if part:IsA("BasePart") and (part.Name=="Main" or part.Name=="Hitbox") then 
            return part 
        end
    end
    for _, part in ipairs(plot:GetDescendants()) do
        if part:IsA("BasePart") then return part end
    end
    return nil
end

local function createMinecraftESP(part, text)
    local gui = Instance.new("BillboardGui")
    gui.Name="MinecraftESP"
    gui.Adornee=part
    gui.Size=ESP_CONFIG.Size
    gui.StudsOffset=ESP_CONFIG.Offset
    gui.AlwaysOnTop=true

    local bg = Instance.new("Frame")
    bg.Size = UDim2.new(1,0,1,0)
    bg.BackgroundColor3 = ESP_CONFIG.Background.Color
    bg.BackgroundTransparency = ESP_CONFIG.Background.Transparency
    bg.BorderSizePixel = 0
    bg.Parent = gui

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1,0,1,0)
    label.BackgroundTransparency = 1
    label.TextScaled = true
    label.Font = ESP_CONFIG.Text.Font
    label.TextColor3 = ESP_CONFIG.Text.Color
    label.TextStrokeTransparency = ESP_CONFIG.Text.StrokeTransparency
    label.TextStrokeColor3 = ESP_CONFIG.Text.StrokeColor
    label.Text = text
    label.Parent = bg

    if ESP_CONFIG.Border.Enabled then
        local stroke = Instance.new("UIStroke")
        stroke.Thickness = ESP_CONFIG.Border.Thickness
        stroke.Color = ESP_CONFIG.Border.Color
        stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        stroke.Parent = bg
    end

    gui.Parent = part
    table.insert(espList,gui)
end

-- Vòng lặp chính
while _G.runMyESPScript do
    clearESP()
    for _, plot in ipairs(plotsFolder:GetChildren()) do
        if plot:IsA("Model") then
            local part = findESPPart(plot)
            local seconds = getRemainingTimeText(plot)
            if part and seconds then
                createMinecraftESP(part, seconds.."s")
            end
        end
    end
    task.wait(0.3)
end

clearESP()
