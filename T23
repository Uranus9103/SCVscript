-- LocalScript: StarterPlayerScripts
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- Lấy Character
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local humanoid = char:WaitForChild("Humanoid")

-- Biến lưu vị trí reset
local resetPosition = hrp.Position
local movedBack = false

-- Tạo Part gắn trên người
local part = Instance.new("Part")
part.Size = Vector3.new(2, 1, 2)
part.Anchored = false
part.CanCollide = false
part.Parent = char
part.Position = hrp.Position + Vector3.new(0, 3, 0)

local weld = Instance.new("WeldConstraint")
weld.Part0 = hrp
weld.Part1 = part
weld.Parent = part

-- GUI
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.ResetOnSpawn = false

local button = Instance.new("TextButton")
button.Size = UDim2.new(0,150,0,50)
button.Position = UDim2.new(0,50,0,50)
button.Text = "Move Back"
button.TextScaled = true
button.BackgroundColor3 = Color3.fromRGB(0,170,255)
button.Parent = screenGui

-- BodyVelocity / BodyPosition để anti giật
local bodyPos = Instance.new("BodyPosition")
bodyPos.MaxForce = Vector3.new(1e5,1e5,1e5)
bodyPos.P = 1e4
bodyPos.D = 500
bodyPos.Position = hrp.Position
bodyPos.Parent = hrp

-- Hàm di chuyển mượt về vị trí
local function moveToPosition(targetPos)
    bodyPos.Position = targetPos
end

-- Tự động reset khi vào game
hrp.CFrame = CFrame.new(hrp.Position + Vector3.new(0,5,0))
resetPosition = hrp.Position
bodyPos.Position = resetPosition

-- RenderStepped để giữ anti giật / anti về chỗ cũ
RunService.RenderStepped:Connect(function()
    if not movedBack then
        bodyPos.Position = resetPosition
    end
end)

-- Nút click để di chuyển về vị trí reset
button.MouseButton1Click:Connect(function()
    movedBack = true
    moveToPosition(resetPosition)
end)

-- Đảm bảo BodyPosition luôn gắn HumanoidRootPart
hrp.Anchored = false
