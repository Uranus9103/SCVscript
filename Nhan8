local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- GUI ch√≠nh
local gui = player:WaitForChild("PlayerGui"):FindFirstChild("MainGui")
if not gui then
	gui = Instance.new("ScreenGui")
	gui.Name = "MainGui"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")
end

-- N√∫t ·∫©n/hi·ªán menu
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 120, 0, 40)
toggleBtn.Position = UDim2.new(1, -130, 0, 10)
toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 200)
toggleBtn.Text = "üìÇ Menu"
toggleBtn.TextScaled = true
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.GothamBold
toggleMenuBtn.Active = true
toggleMenuBtn.Draggable = true
toggleBtn.Parent = gui

local cornerToggle = Instance.new("UICorner")
cornerToggle.CornerRadius = UDim.new(0, 10)
cornerToggle.Parent = toggleBtn

-- Khung menu (c√≥ th·ªÉ k√©o th·∫£)
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 220, 0, 250)
frame.Position = UDim2.new(0.05, 0, 0.2, 0)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.Active = true
frame.Draggable = true
frame.Visible = true
frame.Parent = gui

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 12)
frameCorner.Parent = frame

-- Thanh cu·ªôn
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1, -10, 1, -10)
scroll.Position = UDim2.new(0, 5, 0, 5)
scroll.CanvasSize = UDim2.new(0, 0, 2, 0)
scroll.ScrollBarThickness = 8
scroll.BackgroundTransparency = 1
scroll.Parent = frame

-- H√†m t·∫°o n√∫t trong menu
local function createButton(text)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.9, 0, 0, 40)
	btn.Position = UDim2.new(0.05, 0, 0, (#scroll:GetChildren()-1)*45)
	btn.Text = text
	btn.TextScaled = true
	btn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.Parent = scroll

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 10)
	corner.Parent = btn

	return btn
end

-- C√°c n√∫t (v√≠ d·ª•)
local btnLift = createButton("‚¨ÜÔ∏è N√¢ng OFF")
local btnFly = createButton("üõë ƒêi Tr√™n Kh√¥ng OFF")
local btnESP = createButton("üëÅÔ∏è ESP Ng∆∞·ªùi Ch∆°i OFF")
local btnWarn = createButton("‚ö†Ô∏è C·∫£nh b√°o g·∫ßn OFF")

-- Th√¥ng b√°o tr√™n c√πng m√†n h√¨nh
local warnLabel = Instance.new("TextLabel")
warnLabel.Size = UDim2.new(1, 0, 0, 40)
warnLabel.Position = UDim2.new(0, 0, 0, 0)
warnLabel.BackgroundTransparency = 0.3
warnLabel.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
warnLabel.Text = ""
warnLabel.TextScaled = true
warnLabel.Visible = false
warnLabel.TextColor3 = Color3.new(1, 1, 1)
warnLabel.Font = Enum.Font.GothamBold
warnLabel.Parent = gui

-- Bi·∫øn
local espEnabled = false
local warnEnabled = false
local espConnections = {}

-- H√†m ESP
local function toggleESP()
	espEnabled = not espEnabled
	if espEnabled then
		btnESP.Text = "üëÅÔ∏è ESP Ng∆∞·ªùi Ch∆°i ON"
		btnESP.BackgroundColor3 = Color3.fromRGB(50, 200, 50)

		for _, p in pairs(Players:GetPlayers()) do
			if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESPTag"
				billboard.Size = UDim2.new(0, 100, 0, 50)
				billboard.Adornee = p.Character.HumanoidRootPart
				billboard.AlwaysOnTop = true
				billboard.Parent = p.Character

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.Text = p.Name
				label.TextColor3 = Color3.fromRGB(255, 0, 0)
				label.TextScaled = true
				label.Parent = billboard
			end
		end

		espConnections["Added"] = Players.PlayerAdded:Connect(function(p)
			p.CharacterAdded:Connect(function(char)
				char:WaitForChild("HumanoidRootPart")
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESPTag"
				billboard.Size = UDim2.new(0, 100, 0, 50)
				billboard.Adornee = char.HumanoidRootPart
				billboard.AlwaysOnTop = true
				billboard.Parent = char

				local label = Instance.new("TextLabel")
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.Text = p.Name
				label.TextColor3 = Color3.fromRGB(255, 0, 0)
				label.TextScaled = true
				label.Parent = billboard
			end)
		end)
	else
		btnESP.Text = "üëÅÔ∏è ESP Ng∆∞·ªùi Ch∆°i OFF"
		btnESP.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		for _, p in pairs(Players:GetPlayers()) do
			if p.Character and p.Character:FindFirstChild("ESPTag") then
				p.Character.ESPTag:Destroy()
			end
		end
		for _, conn in pairs(espConnections) do
			conn:Disconnect()
		end
	end
end

-- H√†m c·∫£nh b√°o khi c√≥ ng∆∞·ªùi ƒë·∫øn g·∫ßn
local function toggleWarn()
	warnEnabled = not warnEnabled
	if warnEnabled then
		btnWarn.Text = "‚ö†Ô∏è C·∫£nh b√°o g·∫ßn ON"
		btnWarn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)

		RunService.RenderStepped:Connect(function()
			if not warnEnabled then return end
			local char = player.Character
			if not char or not char:FindFirstChild("HumanoidRootPart") then return end
			local hrp = char.HumanoidRootPart

			local danger = false
			for _, p in pairs(Players:GetPlayers()) do
				if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
					if (p.Character.HumanoidRootPart.Position - hrp.Position).Magnitude < 15 then
						danger = true
						break
					end
				end
			end

			if danger then
				warnLabel.Visible = true
				warnLabel.Text = "‚ö†Ô∏è C·∫©n th·∫≠n! C√≥ ng∆∞·ªùi l·∫°i g·∫ßn!\n‚ö†Ô∏è Careful! Someone is near!"
			else
				warnLabel.Visible = false
			end
		end)
	else
		btnWarn.Text = "‚ö†Ô∏è C·∫£nh b√°o g·∫ßn OFF"
		btnWarn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		warnLabel.Visible = false
	end
end

-- K·∫øt n·ªëi c√°c n√∫t
btnESP.MouseButton1Click:Connect(toggleESP)
btnWarn.MouseButton1Click:Connect(toggleWarn)

-- N√∫t ·∫©n hi·ªán menu
toggleBtn.MouseButton1Click:Connect(function()
	frame.Visible = not frame.Visible
end)
